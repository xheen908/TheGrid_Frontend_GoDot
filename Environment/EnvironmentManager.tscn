[gd_scene load_steps=9 format=3 uid="uid://c5w2x4y5j6l1m"]

[ext_resource type="Script" path="res://Environment/EnvironmentManager.gd" id="1_script"]

[sub_resource type="ProceduralSkyMaterial" id="ProceduralSkyMaterial_sky"]
sky_top_color = Color(0.1, 0.6, 1, 1)
sky_horizon_color = Color(0.4, 0.8, 1, 1)
ground_bottom_color = Color(0.1, 0.1, 0.1, 1)

[sub_resource type="Sky" id="Sky_env"]
sky_material = SubResource("ProceduralSkyMaterial_sky")

[sub_resource type="Environment" id="Environment_main"]
background_mode = 2
sky = SubResource("Sky_env")
ambient_light_source = 3
ambient_light_color = Color(0.5, 0.5, 0.5, 1)
ambient_light_sky_contribution = 0.5
tonemap_mode = 3
glow_enabled = true
fog_enabled = true
fog_light_color = Color(0.5, 0.6, 0.7, 1)
fog_density = 0.001

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_rain"]
emission_shape = 3
emission_box_extents = Vector3(50, 1, 50)
direction = Vector3(0, -1, 0)
spread = 5.0
initial_velocity_min = 20.0
initial_velocity_max = 30.0

[sub_resource type="BoxMesh" id="BoxMesh_rain"]
size = Vector3(0.05, 0.5, 0.05)

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_snow"]
emission_shape = 3
emission_box_extents = Vector3(50, 1, 50)
direction = Vector3(0, -1, 0)
spread = 20.0
initial_velocity_min = 2.0
initial_velocity_max = 5.0
gravity = Vector3(0, -1, 0)

[sub_resource type="SphereMesh" id="SphereMesh_snow"]
radius = 0.05
height = 0.1

[node name="EnvironmentManager" type="Node3D"]
script = ExtResource("1_script")
sun_path = NodePath("Sun")
moon_path = NodePath("Moon")
world_env_path = NodePath("WorldEnvironment")
rain_particles = NodePath("RainParticles")
snow_particles = NodePath("SnowParticles")

[node name="Sun" type="DirectionalLight3D" parent="."]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 10, 0)
shadow_enabled = true
shadow_bias = 0.04
shadow_normal_bias = 2.0
shadow_blur = 1.5
directional_shadow_max_distance = 150.0
directional_shadow_pcf_size = 1

[node name="Moon" type="DirectionalLight3D" parent="."]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, -1, 0, 1, -4.37114e-08, 0, 10, 0)
light_color = Color(0.6, 0.7, 1, 1)
light_energy = 0.5

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_main")

[node name="RainParticles" type="GPUParticles3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 20, 0)
emitting = false
amount = 2000
lifetime = 2.0
process_material = SubResource("ParticleProcessMaterial_rain")
draw_pass_1 = SubResource("BoxMesh_rain")

[node name="SnowParticles" type="GPUParticles3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 20, 0)
emitting = false
amount = 3000
lifetime = 5.0
process_material = SubResource("ParticleProcessMaterial_snow")
draw_pass_1 = SubResource("SphereMesh_snow")
